
메모리와 포인터에 대해 알아보았다. 

그럼 코드를 작성해서 컴파일하고 프로그램을 실행시킬 때 **어떤 구조로 메모리에 할당**이 되는지 알아보자

> **in 운영체제**

-   운영체제는 **프로세스에 적절한 메모리를 할당**하는데 아래 구조를 기반으로 한다.
-   위에서부터 **스택(stack), 힙(heap), 데이터 영역(BSS segment, Data segment), 코드 영역 (code segment)**
-   **스택**은 위 주소부터 할당, **힙**은 아래 주소부터 할당

![](https://blog.kakaocdn.net/dn/cK1kmN/btr0sANw2A5/cCAizOYqXfYAFSHah2rZj1/img.png)

-   **스택**   
    -   지역변수, 매개변수, 함수가 저장되고 **컴파일 시에 크기가 결정**된다.
    -   그러나 함수가 함수를 호출하는 등에 따라 **런타임시에도 크기가 변경**된다. [동적인 특징]
-   **힙**
    -   힙은 **동적 할당**할 때 사용되며 **런타임 시 크기가 결정**된다. [동적인 특징]
-   **데이터영역**
    -   BSS 영역과 Data 영역으로 나뉘고 **정적할당**에 관한 부분을 담당한다. [정적인 특징]
-   **코드영역**
    -   **소스코드** 들어감 [정적인 특징]

---

### **1. 정적할당**

-   **컴파일 단계**에서 메모리를 할당하는 것을 말함
-   BSS segment와 Data segment, code / tedxt segment 로 나뉘어서 저장

![](https://blog.kakaocdn.net/dn/Ijrjb/btr0r6eDhUy/ANPWQOZkubx9frzUhVJaW0/img.png)

-   **BSS segment**는 **전역변수**, **static**, **const**로 선언되어있는 변수 중 0으로 초기화 또는 초기화가 어떠한 값으로도 되어 있지 않은 변수들이 이 메모리 영역에 할당

```cpp
#include<bits/stdc++.h>
using namespace std;
int a;
int b= 0;
const int c = 0;
int main(){
	static int d;
    static int e = 0;
    return 0;
}
```

-   **Data segment**은 **전역변수, static, const**로 선언되어있는 변수 중 0이 아닌 값으로 초기화된 변수가 이 메모리 영역에 할당

```cpp
#include<bits/stdc++.h>
using namespace std;
int a = 1;
const int b = 2;
int main(){
    static int c = 3;
    return 0;
}
```

---

### **2. 동적할당**

-   **런타임단계**에서 메모리를 할당받는 것
-   **Stack과 Heap**으로 나뉜다.

![](https://blog.kakaocdn.net/dn/EX4Di/btr0o7FGtIm/5LFt6sNokeJJptzcETymX1/img.png)

-   **Stack**은 **지역변수, 매개변수, 실행되는 함수**에 의해 **늘어나거나 줄어드는 메모리 영역**
    -   함수가 호출될 때마다 호출될 때의 환경 등 특정 정보가 stack에 계쏙해서 저장
    -   재귀함수가 호출된다고 했을 때 **새로운 스택 프레임이 매번 사용**되기 때문에 함수 내의 변수 집합이 해당 함수의 다른 인스턴스 변수를 방해 xxxx
-   **Heap**은 **동적으로 할당**되는 변수들을 담는다.
    -   **malloc(), free()** 함수를 통해 관리 가능
    -   동적으로 관리되는 자료구조의 경우 **Heap** **영역** 사용
    -   ex) **vector**는 내부적으로 heap영역 사용